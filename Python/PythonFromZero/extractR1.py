#coding=utf-8
import re 
import xlrd
import csv

strR =";  EP2439788-A2 -- JP2002094089-A   HONDA MOTOR CO LTD (HOND)   UEDA H;  WO2009110093-A1   SHOWA SHELL SEKIYU KK (SHEL)   HAKUMA H,  TANAKA Y,  ARAMOTO T,  KUSHIYA K;  KR1210168-B1 -- JP2002094089-A   HONDA MOTOR CO LTD (HOND)   UEDA H;  KR2010025429-A   TG SOLAR CORP (TGSO-Non-standard)   JANG I G,  JANG S P,  JANG T Y,  KIM D J,  LEE B I,  LEE Y H,  LEE Y J;  KR2010026710-A   LG ELECTRONICS INC (GLDS)   AHN S,  CHOI J H,  EO Y J,  KIM S H,  LEE H M,  LEE S,  MOON K S;  US20090014052-A1   ;  US2013008496-A1 -- US20070131271-A1   ;  US20090014052-A1   ;  US20100147384-A1   ;  US20110011451-A1   ;  US7141863-B1   UNIV TOLEDO (UYTO-Non-standard)   COMPAAN A D,  GUPTA A;  WO2009110093-A1   SHOWA SHELL SEKIYU KK (SHEL)   HAKUMA H,  TANAKA Y,  ARAMOTO T,  KUSHIYA K;  CN102844879-A -- CN1866546-A   WEIHAI BLUE STAR GLASS GROUP CO LTD (WEIH-Non-standard)   MO J,  WANG W,  WANG J,  XIE X,  WANG H,  LIU X;  JP2002094089-A   HONDA MOTOR CO LTD (HOND)   UEDA H;  US20090014052-A1   ;  WO2009110093-A1   SHOWA SHELL SEKIYU KK (SHEL)   HAKUMA H,  TANAKA Y,  ARAMOTO T,  KUSHIYA K;  US8962984-B2 -- CN1866546-A   WEIHAI BLUE STAR GLASS GROUP CO LTD (WEIH-Non-standard)   MO J,  WANG W,  WANG J,  XIE X,  WANG H,  LIU X;  JP59220979-A   SANYO ELECTRIC CO (SAOL)   YAMANO M,  NAGAOKA I,  KUWANO Y,  KAWADA H,  SAKAI S;  JP2002094089-A   HONDA MOTOR CO LTD (HOND)   UEDA H;  JP2009135517-A   SHOWA SHELL SEKIYU KK (SHEL)   FUJIWARA Y,  HAKUMA H,  KUSHIYA K,  TABUCHI K;  JP73026977-B1   ;  KR2010025429-A   TG SOLAR CORP (TGSO-Non-standard)   JANG I G,  JANG S P,  JANG T Y,  KIM D J,  LEE B I,  LEE Y H,  LEE Y J;  KR2010026710-A   LG ELECTRONICS INC (GLDS)   AHN S,  CHOI J H,  EO Y J,  KIM S H,  LEE H M,  LEE S,  MOON K S;  US20070131271-A1   ;  US20090014052-A1   ;  US20100059100-A1   ;  US20100147384-A1   ;  US20110011451-A1   ;  US20110023963-A1   ;  US7141863-B1   UNIV TOLEDO (UYTO-Non-standard)   COMPAAN A D,  GUPTA A;  WO2009110093-A1   SHOWA SHELL SEKIYU KK (SHEL)   HAKUMA H,  TANAKA Y,  ARAMOTO T,  KUSHIYA K;  WO2009116626-A1   NAT INST ADVANCED IND SCI&TECHNOLOGY (NIIT);  TEIJIN LTD (TEIJ)   ISHIZUKA S,  NIKI S,  KIDO N,  HONMOTO H;  CN102844879-B -- CN1866546-A   WEIHAI BLUE STAR GLASS GROUP CO LTD (WEIH-Non-standard)   MO J,  WANG W,  WANG J,  XIE X,  WANG H,  LIU X;  JP2002094089-A   HONDA MOTOR CO LTD (HOND)   UEDA H;  US20090014052-A1   ;  WO2009110093-A1   SHOWA SHELL SEKIYU KK (SHEL)   HAKUMA H,  TANAKA Y,  ARAMOTO T,  KUSHIYA K;  JP5881675-B2 -- JP11312815-A   MATSUSHITA DENKI SANGYO KK (MATU)   SHIMAKAWA S,  NEGAMI T,  WADA T;  JP59220979-A   SANYO ELECTRIC CO (SAOL)   YAMANO M,  NAGAOKA I,  KUWANO Y,  KAWADA H,  SAKAI S;  JP2002094089-A   HONDA MOTOR CO LTD (HOND)   UEDA H;  WO2009110093-A1   SHOWA SHELL SEKIYU KK (SHEL)   HAKUMA H,  TANAKA Y,  ARAMOTO T,  KUSHIYA K;  WO2009116626-A1   NAT INST ADVANCED IND SCI&TECHNOLOGY (NIIT);  TEIJIN LTD (TEIJ)   ISHIZUKA S,  NIKI S,  KIDO N,  HONMOTO H;  EP2439788-A4 -- JP2002094089-A   HONDA MOTOR CO LTD (HOND)   UEDA H;  WO2009110093-A1   SHOWA SHELL SEKIYU KK (SHEL)   HAKUMA H,  TANAKA Y,  ARAMOTO T,  KUSHIYA K"
pattern = re.compile(r';  ([A-Z]{2,}\d{7,}-[A-Z]{1}\d{0,})  ')  
result1 = pattern.findall(strR)    
pattern = re.compile(r' -- ([A-Z]{2,}\d{7,}-[A-Z]{1}\d{0,})')
result2 = pattern.findall(strR)
 
print( set(result1 + result2))
# print(set(result1))
# print(",".join(set(result1)))

# -- JP2002094089-A
# ;  WO2009110093-A1


# file = 'r.xlsx'
# wb = xlrd.open_workbook(filename=file)      #打开文件
# sheet1 = wb.sheet_by_index(0)               #通过索引获取表格

# with open('r.csv', 'w') as csvfile:
#     writer = csv.writer(csvfile)
#     writer.writerow(['newR'])
#     for i in range(1,sheet1.nrows):
#         rcontent = sheet1.cell(i,17).value
#         pattern = re.compile(r';  ([A-Z]{2,}\d{10}-[A-Z]{1}\d{0,})')  
#         result1 = pattern.findall(rcontent)
#         rnewcontent = ",".join(set(result1))
#         # print(rnewcontent)

#         writer.writerow([rnewcontent])