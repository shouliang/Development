<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title></title>
</head>
<body>
<button id="loginBtn">登录</button>
</body>
<script>
    // 页面加载完成后就创建登录div
    //    var loginLayer = (function () {
    //        var div = document.createElement('div');
    //        div.innerHTML = '我是登录浮窗';
    //        div.style.display = 'none';
    //        document.body.appendChild(div);
    //        return div;
    //    })();
    //
    //    document.getElementById('loginBtn').onclick = function () {
    //        loginLayer.style.display = 'block';
    //    };


    // 点击登录按钮的时候才创建登录div
    //    var createLoginLayer = function () {
    //        var div = document.createElement('div');
    //        div.innerHTML = '我是登录浮窗';
    //        div.style.display = 'none';
    //        document.body.appendChild(div);
    //        return div;
    //    };
    //
    //    document.getElementById('loginBtn').onclick = function () {
    //        var loginLayer = createLoginLayer();
    //        loginLayer.style.display = 'block';
    //    };

    // 单例
    //    var createLoginLayer = (function () {
    //        var div;
    //        return function () {
    //            if (!div) {
    //                div = document.createElement('div');
    //                div.innerHTML = '我是登录浮窗';
    //                div.style.display = 'none';
    //                document.body.appendChild(div);
    //            }
    //
    //            return div;
    //        }
    //    })();
    //
    //    document.getElementById('loginBtn').onclick = function () {
    //        var loginLayer = createLoginLayer();
    //        loginLayer.style.display = 'block';
    //    };

    // 通用的惰性单例
    var getSingle = function (fn) {
        var result;
        return function () {
            return result || ( result = fn.apply(this, arguments));
        }
    };

    //    var createLoginLayer = function () {
    //        var div = document.createElement('div');
    //        div.innerHTML = '我是登录浮窗';
    //        div.style.display = 'none';
    //        document.body.appendChild(div);
    //        return div;
    //    };
    //
    //    var createSingleLoginLayer = getSingle(createLoginLayer);
    //
    //    document.getElementById('loginBtn').onclick = function () {
    //        var loginLayer = createSingleLoginLayer();
    //        loginLayer.style.display = 'block';
    //    };


    var createIframe = function () {
        var iframe = document.createElement('iframe');
        document.body.appendChild(iframe);
        return iframe;
    };

    var createSingleIframe = getSingle(createIframe);

    document.getElementById('loginBtn').onclick = function () {
        var loginLayer = createSingleIframe();
        loginLayer.src = 'http://baidu.com';
    };

    /*接下来将用于创建登录浮窗的方法用参数 fn 的形式传入 getSingle，我们不仅可以传入
     createLoginLayer，还能传入 createScript、 createIframe、 createXhr 等。之后再让 getSingle 返回
     一个新的函数，并且用一个变量 result 来保存 fn 的计算结果。 result 变量因为身在闭包中，它
     永远不会被销毁。在将来的请求中，如果 result 已经被赋值，那么它将返回这个值。*/


    /*
     在这个例子中，我们把创建实例对象的职责和管理单例的职责分别放置在两个方法里，这两
     个方法可以独立变化而互不影响，当它们连接在一起的时候，就完成了创建唯一实例对象的功能
     */

</script>
</html>